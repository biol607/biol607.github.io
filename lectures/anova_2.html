<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Many Types of Categories: Multi-way and Factorial ANOVA</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/shinobi.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: center, middle
background-image: url(images/21/blocked_designs/Slide4.jpg)
background-size:cover

# Many Types of Categories: Multi-Way and Factorial ANOVA




---
class: center, middle

# Etherpad
&lt;br&gt;&lt;br&gt;
&lt;center&gt;&lt;h3&gt;https://etherpad.wikimedia.org/p/607-anova-2020&lt;/h3&gt;&lt;/center&gt;

---
class: center, middle
![image](./images/21/anova-3.jpg)


---
# Many Categorical Predictors = Fun!

1. Combining Multiple Categorical Variables

2. Analyzing a Multi-way Model

3. Replicating Categorical Variable Combinations: Factorial Models

4. The Implications of Interaction Effects

---

# Effects of Stickleback Density on Zooplankton
&lt;br&gt;&lt;br&gt;
.pull-left[
![image](./images/21/daphnia.jpeg)
]

.pull-right[
![image](./images/21/threespine_stickleback.jpeg)
]

---
# More Than One Group with a Randomized Controlled Blocked Design
![image](./images/21/blocked_designs/Slide4.jpg)

---

# Effects of Stickleback Density on Zooplankton
&lt;br&gt;&lt;br&gt;
.pull-left[
![image](./images/21/daphnia.jpeg)
]

.pull-right[
![image](./images/21/threespine_stickleback.jpeg)
]

.center[
Units placed across a lake so that 1 set of each treatment was ’blocked’ together
]

---
# Effects of Both Treatment and Block

&lt;img src="anova_2_files/figure-html/zooplankton_boxplot-1.png" style="display: block; margin: auto;" /&gt;

---
# Multiway ANOVA
- Many different treatment types  
     - 2-Way ANOVA is for Treatment and block
     - 3-Way for, e.g., Sticklebacks, Nutrients, and block
     - 4-way, etc., all possible  

--


- Assumes treatments are fully orthogonal  
    - Each type of treatment type A has all levels of treatment type B
    - E.g., Each stickleback treatment is present in each block

--

- Experiment is **balanced** for **simple effects**  
      - Simple effect is the unique combination of two or more treatments  
      - Balance implies the sample size for each treatment combination is the same  

--

- But, we can model even if unbalanced
     - Just need to adjust on how we evaluate the model

---
# Treatment Contrast Model for Multiway ANOVA/ANODEV/BANOVA

`$$y_{ijk} = \beta_{0} + \sum \beta_{i}x_{i} + \sum \beta_{j}x_{j} + \epsilon_{ijk}$$`  

`$$\epsilon_{ijk} \sim N(0, \sigma^{2} )$$`

`$$\qquad x_{i} = 0,1$$`
`$$\qquad x_{j} = 0,1$$` 

i = treatment type 1, j = treatment type 2, k = replicate `\(\beta_0\)` = reference treatment combination (i.e, control block 1) 




--



Or, with matrices, a general linear model...  

`$$\boldsymbol{Y} = \boldsymbol{\beta X} + \boldsymbol{\epsilon}$$`

---

# What does a Multiple Category Model Look like in Data?

Data
&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; treatment &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; zooplankton &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; block &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; control &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; low &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; high &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; control &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; low &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; high &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# What does a Multiple Category Model Look like in Data?

Data Prepped for Model
&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; (Intercept) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; treatmenthigh &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; treatmentlow &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; block2 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; block3 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; block4 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; block5 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Fits

**Least Squares**

```r
zoop_lm &lt;- lm(zooplankton ~ treatment + block, 
              data=zoop)
```

**Likelihood**

```r
zoop_glm &lt;- glm(zooplankton ~ treatment + block,
                data=zoop,
                family = gaussian(link = "identity"))
```

**Bayesian**

```r
zoop_brm &lt;- brm(zooplankton ~ treatment + block,
                data=zoop,
                family = gaussian(link = "identity"),
                chains = 2)
```

---

# Assumptions of Multiway Anova
-   Independence of data points  
  
-   Normality within groups (of residuals)  
  
-   No relationship between fitted and residual values  
  
-   Homoscedasticity (homogeneity of variance) of groups  
  
-   .red[Additivity of Treatments]

---
# The Usual Suspects of Assumptions
&lt;img src="anova_2_files/figure-html/zoop_assumptions-1.png" style="display: block; margin: auto;" /&gt;

---
# Group Residuals
&lt;img src="anova_2_files/figure-html/zoop_group_assumptions-1.png" style="display: block; margin: auto;" /&gt;

We now want to look at both sets of categories to evaluate HOV

---
# Group Residuals

Levene Test for Treatment
&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; group &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3315789 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7241614 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

Levene Test for Block
&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; group &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4241486 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7880527 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# 
## Tukey's Test of Non-additivity:
- Our model is `\(y_{ij} = \mu + \alpha_i + \beta_j + \epsilon_{ij}\)`  

--

- But, if A and B are non-additive, results are incorrect.
    - Our model doesn't have an A*B term

--

- We don't have the DF with n=1 per treatment combination to calculate an interaction, so...  

--

- Assume a model of `\(y_{ij} = \mu + \alpha_i + \beta_j + \lambda\alpha_i\beta_j\)`  

--

- We can then test for `\(SS_{AB}\)` using `\(\lambda\alpha_i\beta_j\)`  

---
# Tukey's Test of Non-additivity


```
           Test stat Pr(&gt;|Test stat|)
block                                
Tukey test    0.4742           0.6354
```



---
# Many Categorical Predictors = Fun!

1. Combining Multiple Categorical Variables

2. .red[Analyzing a Multi-way Model]

3. Replicating Categorical Variable Combinations: Factorial Models

4. The Implications of Interaction Effects

---
# What now?

- Which categories are associated with variability in our response?
     - ANOVA/ANODEV/BANOVA
     
- How much variability are we explaining?

- Do we want to compare to simpler models for predictive ability?

- Comparison of Means

---
# Hypotheses for Multiway ANOVA/ANODEV


TreatmentHo: `\(\mu_{i1} = \mu{i2} = \mu{i3} = ...\)`


Block Ho: `\(\mu_{j1} = \mu{j2} = \mu{j3} = ...\)`


i.e., The variane due to each treatment type is no different than noise

---
# We Decompose Sums of Squares for Multiway ANOVA

`\(SS_{Total} = SS_{Between A} + SS_{Between B} + SS_{Within}\)`

- Factors are Orthogonal and Balanced, so, Model SS can be split
     -   F-Test using Mean Squares as Before

- OR we compare y ~ a versus y ~ b to see if y ~ a + b has a higher likelihood
     - ANODEV LRT
     - Can also be done with F tests
     - Useful if data is unbalanced (called **type II comparison**)

---
# Put it to the Test

### F-Test
&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sumsq &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; meansq &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; F &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; treatment &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.857333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.428667 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.365951 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0014881 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; block &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.340000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.585000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.792363 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1010308 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Residuals &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.676000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.209500 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:right;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

`\(R^2\)` = 0.846

--
### ANODEV

&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; LR Chisq &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; treatment &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.73190 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000001 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; block &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.16945 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0247242 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# AIC Analysis of Alternate Models - the models


```r
zoop_only_trt &lt;- lm(zooplankton ~ treatment,
                     data = zoop)

zoop_only_block &lt;- lm(zooplankton ~  block, 
                     data = zoop)

zoop_nuts_matter &lt;- lm(zooplankton ~ 
                         I(treatment !="control")+ 
                         block, 
                     data = zoop)

zoop_null &lt;- lm(zooplankton ~ 1, 
                     data = zoop)
```

---
# AIC Analysis of Alternate Models - Predictive Ability

&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Modnames &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; K &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; AICc &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Delta_AICc &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; AICcWt &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Only trt &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.80170 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9781236 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Null &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42.74210 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.940404 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0184568 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Nuts or Control &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46.49203 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.690333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0028305 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; All &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.69355 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.891854 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0005710 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Only Block &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56.60710 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21.805405 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000180 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# How to evaluate effects of each treatment
1. Examine means estimates  



2. Evaluate treatment after parcelling out effect of other treatment  



3. Evaluate treatment at the median or mean level of other treatment


---
# Evaluating Means

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; treatmentcontrol &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3126766 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.9378182 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000043 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; treatmenthigh &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.78 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3126766 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.6927826 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0004582 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; treatmentlow &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.40 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3126766 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.6756619 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000588 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; block2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3737200 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0000000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; block3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.70 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3737200 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.8730599 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0979452 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; block4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3737200 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.6757998 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0281084 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; block5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3737200 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.8027399 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4453163 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Parcelling Out Second Treatment
&lt;img src="anova_2_files/figure-html/visualize_treatments-1.png" style="display: block; margin: auto;" /&gt;

Component-Residual Plots take examine unique effect of one treatment after removing influence of the other.

---
# Median Value of Second Treatment
&lt;img src="anova_2_files/figure-html/visreg-1.png" style="display: block; margin: auto;" /&gt;

---
# Comparison of Differences at Average of Other Treatment
&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; contrast &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower.HPD &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper.HPD &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; control - high &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6222387 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9075445 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.312269 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; control - low &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0123920 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3131533 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.743134 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; high - low &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.6112915 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.3635940 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.095609 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

Can use whatever contrast style you'd like, and can do this for any set of categories


---
# Many Categorical Predictors = Fun!

1. Combining Multiple Categorical Variables

2. Analyzing a Multi-way Model

3. .red[Replicating Categorical Variable Combinations: Factorial Models]

4. The Implications of Interaction Effects


---
# The world isn't additive

-   Until now, we have assumed factors combine additively - the effect of one is not dependent on the effect of the other

--

-   BUT - what if the effect of one factor depends on another?

--

-   This is an **INTERACTION** and is quite common

--

- Biology: The science of "It depends..."  

--

-   This is challenging to think about and visualize, but if you can master it, you will go far!

---
# Intertidal Grazing!
.center[
![image](./images/22/grazing-expt.jpeg)

#### Do grazers reduce algal cover in the intertidal?
]

---
# Experiment Replicated on Two Ends of a gradient

![image](./images/22/zonation.jpg)

---
# Factorial Experiment

![image](./images/22/factorial_blocks.jpg)

---
# Factorial Design

![image](./images/22/factorial_layout.jpg)

Note: You can have as many treatment types or observed category combinations as you want (and then 3-way, 4-way, etc. interactions)

---
# The Data: See the dependency of one treatment on another?

&lt;img src="anova_2_files/figure-html/plot_algae-1.png" style="display: block; margin: auto;" /&gt;

---
# If we had fit y ~ a + b, residuals look weird
&lt;img src="anova_2_files/figure-html/graze_assumptions-1.png" style="display: block; margin: auto;" /&gt;

A Tukey Non-Additivity Test would Scream at us

---
# A Factorial Model

`$$y_{ijk} = \beta_{0} + \sum \beta_{i}x_{i} + \sum \beta_{j}x_{j} + \sum \beta_{ij}x_{ij} + \epsilon_{ijk}$$`  

`$$\epsilon_{ijk} \sim N(0, \sigma^{2} )$$`
`$$x_{i} = 0,1, x_{j} = 0,1, x_{ij} = 0,1$$` 


- Note the new last term  

- Deviation due to treatment combination  


--

&lt;hr&gt;
This is still something that can be in the form

`$$\boldsymbol{Y} = \boldsymbol{\beta X} + \boldsymbol{\epsilon}$$`

---
# The Dummy-Coded Data

&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; (Intercept) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; heightmid &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; herbivoresplus &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; heightmid:herbivoresplus &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Fitting

**Least Squares**

```r
graze_int &lt;- lm(sqrtarea ~ height + herbivores +
                  height:herbivores,
                data=algae)
## OR
graze_int &lt;- lm(sqrtarea ~ height*herbivores,
                data=algae)
```

--

**Likelihood**

```r
graze_int_glm &lt;- glm(sqrtarea ~ height*herbivores,
                data=algae,
                family = gaussian(link = "identity"))
```


**Bayes**

```r
graze_int_brm &lt;- brm(sqrtarea ~ height*herbivores,
                data=algae,
                family = gaussian(link = "identity"),
                chains = 2)
```

---
# Assumptions are Met
&lt;img src="anova_2_files/figure-html/graze_assumptions_int-1.png" style="display: block; margin: auto;" /&gt;


---
# Many Categorical Predictors = Fun!

1. Combining Multiple Categorical Variables

2. Analyzing a Multi-way Model

3. Replicating Categorical Variable Combinations: Factorial Models

4. .red[The Implications of Interaction Effects]


---
# Omnibus Tests for Interactions

- Can do an F-Test

`$$SS_{Total} = SS_{A} + SS_{B} + SS_{AB} +SS_{Error}$$`

`$$SS_{AB} = n\sum_{i}\sum_{j}(\bar{Y_{ij}} - \bar{Y_{i}}- \bar{Y_{j}} - \bar{Y})^{2}$$`
`$$df=(i-1)(j-1)$$`

--


- Can do an ANODEV
    - Compare A + B versus A + B + A:B

--

- Can do CV as we did before, only now one model has an interaction
     - Again, think about what models you are comparing
     
--

- Can look at finite population variance of interaction

---
# Example: ANODEV

&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; LR Chisq &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Pr(&amp;gt;Chisq) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; height &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3740858 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5407855 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; herbivores &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.3579319 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0116858 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; height:herbivores &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.0029142 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0009097 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# What do the  Coefficients Mean?

&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.91450 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.855532 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.536955 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0000000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; heightmid &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -10.43090 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.913034 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0605194 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; herbivoresplus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -22.51075 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4.128484 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0001146 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; heightmid:herbivoresplus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.57809 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.711064 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.317064 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0015486 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

- Intercept chosen as basal condition (low, herbivores -)

--

- Changing height to high is associated with a loss of 10 units of algae relative to low/-

--


- Adding herbivores is associated with a loss of 22 units of algae relative to low/-

--

- BUT - if you add herbivores and mid, that's also associated with an increase of 25 units of algae relative to low/-

--

.center[**NEVER TRY AND INTERPRET ADDITIVE EFFECTS ALONE WHEN AN INTERACTION IS PRESENT**&lt;Br&gt;that way lies madness]

---
# Let's Look at Means, Figures, and Posthocs

.center[.middle[
![image](./images/22/gosling_p_value.jpg)
]]

---
# This view is intuitive

&lt;img src="anova_2_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---
# This view is also intuitive

&lt;img src="anova_2_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---
# Posthocs and Factorial Designs

-   Must look at simple effects first in the presence of an interaction  
     - The effects of individual treatment combinations
     - If you have an interaction, this is what you do!


--

-   Main effects describe effects of one variable in the complete absence of the other
    - Useful only if one treatment CAN be absent
    - Only have meaning if there is no interaction

---
# Posthoc Comparisons Averaging Over Blocks - Misleading!


```
 contrast     estimate   SE df t.ratio p.value
 minus - plus     9.72 3.86 60 2.521   0.0144 

Results are averaged over the levels of: height 
```

---
# Posthoc with Simple Effects

&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; contrast &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SE &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; t.ratio &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; low minus - mid minus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.430905 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.913034 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0605194 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; low minus - low plus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22.510748 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.128484 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0001146 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; low minus - mid plus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.363559 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.350481 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.1819337 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; mid minus - low plus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.079843 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.215450 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0305355 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; mid minus - mid plus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.067346 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.562553 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5758352 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; low plus - mid plus &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -15.147189 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.452546 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.778003 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0072896 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--
.center[**That's a Lot to Drink In!**]

---
# Might be easier visually

&lt;img src="anova_2_files/figure-html/graze_posthoc_plot-1.png" style="display: block; margin: auto;" /&gt;

---
# We are often interested in something simpler...

&lt;img src="anova_2_files/figure-html/graze_posthoc_plot2-1.png" style="display: block; margin: auto;" /&gt;

---
# Why think about interactions

- It Depends is a rule in biology

- Context dependent interactions everywhere

- Using categorical predictors in a factorial design is an elegant way to see interactions without worrying about shapes of relationships

- BUT - it all comes down to a general linear model! And the same inferential frameworks we have been dealing with since day 1

---
# Final Thought - You can have 2, 3, and more-way interactions!

.center[.middle[
![image](./images/22/4_way_interaction.jpg)
]]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="my_macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
