<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>It’s All Linear Models</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/shinobi.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: center, middle

# It's All Linear Models: T-Test Edition

![image](./images/all_linear_models/linear_regression_everywhere.jpg)



---
class: center, middle

# Etherpad
&lt;br&gt;&lt;br&gt;
&lt;center&gt;&lt;h3&gt;https://etherpad.wikimedia.org/p/607-categorical_lm-2022&lt;/h3&gt;&lt;/center&gt;



---
# So, We've Done this Linear Deliciousness
`$$y_i = \beta_0 + \beta_1 x_i + \epsilon_i$$`
`$$\epsilon_i \sim \mathcal{N}(0, \sigma)$$`

&lt;img src="t_as_lm_files/figure-html/pp-1.png" style="display: block; margin: auto;" /&gt;

---

# What if our X Variable Is Categorical
### Comparing Two Means

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-1-1.png" style="display: block; margin: auto;" /&gt;

--
`$$mass_i = \beta_0 + \beta_1 sex_i + \epsilon_i$$`
---

# What if it Has Many Levels
### Comparing Many Means

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /&gt;

--
`$$mass_i =  \beta_1 adelie_i + \beta_2 chinstrap_i + \beta_3 gentoo_i + \epsilon_i$$`


---
class:center

![](images/categorical_lm/corporate_categorical_lm.jpg)

---

# Dummy Codding for Dummy Models

1. The Categorical as Continuous

2. Assumptions of the Categorical

3. Interpretation of Categorical Results

4. Variations on a Theme

---

# We Know the Linear Model
.large[
`$$y_i = \beta_0 + \beta_1 x_i + \epsilon_i$$`
  
`$$\epsilon_i \sim N(0, \sigma)$$`
]

But, what if `\(\beta_1\)` was just 0,1?


---
# Consider Comparing Two Means
#### Consider the Horned Lizard 
.center[
![:scale 50%](images/09/horned_lizard.jpg)
]


Horns prevent these lizards from being eaten by birds. Are horn lengths different between living and dead lizards, indicating selection pressure?

---
background-image: url("./images/09/guiness_full.jpg")
background-position: center
background-size: contain

---
class: center, middle

![](./images/09/gosset.jpg)
---

# The T-Test

.center[![](./images/09/t_unpaired.png)]
--

- Briefly, data is used to calculate a value to compare to a reference distribution  

--

- Different distributions correspond to different assumptions

--

- But we have a more general solution in the linear model

---
# The Data
&lt;img src="t_as_lm_files/figure-html/lizard_load-1.png" style="display: block; margin: auto;" /&gt;

---
# Looking at Means and SE
&lt;img src="t_as_lm_files/figure-html/lizard_mean-1.png" style="display: block; margin: auto;" /&gt;


---
# What is Really Going On?
&lt;img src="t_as_lm_files/figure-html/lizard_mean-1.png" style="display: block; margin: auto;" /&gt;
--
What if we think of Dead = 0, Living = 1

---
# Let's look at it a different way

.center[
![](images/all_linear_models/graph-me.png)
]


---
# First, Recode the Data with Dummy Variables
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Squamosal horn length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Survive &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Status &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 13.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# First, Recode the Data with Dummy Variables
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Squamosal horn length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Survive &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Status &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; StatusDead &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; StatusLiving &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 13.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# But with an Intercept, we don't need Two Dummy Variables
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Squamosal horn length &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Survive &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Status &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; (Intercept) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; StatusLiving &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 13.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 17.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

.center[This is known as a Treatment Contrast structure]

---
# This is Just a Linear Regression
&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

`$$Length_i = \beta_0 + \beta_1 Status_i + \epsilon_i$$`

---

# You're Not a Dummy, Even If You Code a Dummy Variable


`$$Length_i = \beta_0 + \beta_1 Status_i + \epsilon_i$$`

- Setting `\(Status_i\)` to 0 or 1 (Dead or Living) is called Dummy Coding

- We can always turn groups into "Dummy" 0 or 1

- We could even fit a model wit no `\(\beta_0\)` and code Dead = 0 or 1 and Living = 0 or 1

- This approach works for any **unordered categorical (nominal) variable**


---
# Coding this in R


```r
horn_mod &lt;- lm(`Squamosal horn length` ~ Status, 
               data = lizards)

horn_mod
```

```

Call:
lm(formula = `Squamosal horn length` ~ Status, data = lizards)

Coefficients:
 (Intercept)  StatusLiving  
      21.987         2.295  
```


---

# Dummy Codding for Dummy Models

1. The Categorical as Continuous

2. .red[Assumptions of the Categorical]

3. Interpretation of Categorical Results

4. Variations on a Theme

---

# Assumptions are the Same as Linear Regression.... Because this is Linear Regression

1. Validity

2. Representativeness

3. Model captures features in the data

4. Additivity and Linearity

5. Independence of Errors

6. Equal Variance of Errors 

7. Normality of Errors

8. Minimal Outlier Influence
---

# Check Distribution of Predictions

&lt;img src="t_as_lm_files/figure-html/posterior-1.png" style="display: block; margin: auto;" /&gt;

---
# Check Normality of Residuals

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;

---
# Check Normality of Residuals

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---
# Homogeneity of Variance Important for CI Estimation

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---

# Oh No, I can't meet the HOV Assumption!

- You can transform the response variable  
     - log() or asinh()
     
--
     
- You can model the RANKS of the outcome variable
     - This is classically known as a Mann-Whitney U or Wilcoxon Rank Sum test  
     - Your question is does the variable effect the *ranks* of the outcome  
     - Need large sample size, not very precise

--


- You can model the variance  
     - Classically, this is known as Welch's T-Test  
     - Relax assumption of HOV


---

# Transformed Model  - Did it Work?


```r
horn_mod_log &lt;- lm(log(`Squamosal horn length`) ~ Status, 
                    data = lizards)
```

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;

---

# What About Ranks? The Mann Whitney U

.large[$$rank(y_i) = \beta_0 + \beta_1 x_i + \epsilon_i$$]


```
# A tibble: 6 × 5
  `Rank Horn` `Squamosal horn length` Survive Status Status_numeric
        &lt;dbl&gt;                   &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
1           1                    13.1       1 Living              1
2           2                    15.2       0 Dead                0
3           3                    15.5       0 Dead                0
4           4                    15.7       1 Living              1
5           5                    17.2       0 Dead                0
6           6                    17.7       1 Living              1
```

---
# Rank versus Original Values

&lt;img src="t_as_lm_files/figure-html/ranks-1.png" style="display: block; margin: auto;" /&gt;

---
# Rank as Data

&lt;img src="t_as_lm_files/figure-html/ranks_data-1.png" style="display: block; margin: auto;" /&gt;

---
# Rank as Boxplots

&lt;img src="t_as_lm_files/figure-html/ranks_boxplot-1.png" style="display: block; margin: auto;" /&gt;

---

# Ranked Categorical Model aka Mann-Whitney U 

- It's just regression on ranks  

- Why memorize a lot of non-parametrics when they are just transforms?

--


```r
horn_mod_rank &lt;- lm(rank(`Squamosal horn length`) ~ Status, 
                    data = lizards)
```

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.88333 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.260496 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; StatusLiving &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44.94459 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.122384 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# How about those residuals?



&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;


---
# But What if we Just Let Variance.... Vary!

Or.... let variance be different between groups.
i = data point, j = group

`$$y_{ij} = \beta_0 + \beta_1x_j + \epsilon_{ij}$$`
`$$\epsilon_{ij} \sim N(0, \sigma_j)$$`

--

Fit using **weighted least squares** - we weight LS by inverse of variance  

--

Classically, this is known as Welch's T-Test, and is the default for R's `t.test()`
   - Computes a pooled variance based on unequal variance/sample size

---
# Weighting by Variance




```r
library(nlme)
weighted_mod &lt;- gls(squamosal_horn_length ~ Status,
                  weights = varIdent(form = ~1|Status),
                  data = lizards)
```

--

Weighted Least Squares Results versus Unweighted
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; type &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; StatusLiving &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.294502 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5381895 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Modeling Variance &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; StatusLiving &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.294502 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5275497 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Constant Variance &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

Not the hugest difference - remember, these are robust methods!
---

# Dummy Codding for Dummy Models

1. The Categorical as Continuous

2. Assumptions of the Categorical

3. .red[Interpretation of Categorical Results]

4. Variations on a Theme

---

# Our Coefficients and Their Meaning: Treatment Contrasts
`$$y_i = \beta_0 + \beta_1 x_i + \epsilon_i$$`

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21.986667 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4826305 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; StatusLiving &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.294502 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5275497 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--
- The baseline category is Dead - it's alphabetical 

--

- It has a mean of ~21.98 ± 0.48SE
     - This is `\(\beta_0\)`

--

- Living lizards have horns that are ~ 2.29 ± 0.52SE bigger
      - This is `\(\beta_1\)`
     
     
     
---

# I Hate Treatment Contrasts - Let's Look at Model Expected Means

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Status &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Dead &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21.99 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.48 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24.28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.21 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

---

# We can also see if they are different from each other

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; contrast &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; null.value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Dead - Living &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.53 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

.center[This is the 'treatment contrast' from before!]

---

# We can also see if they are different from each other (with 95% CI)

&lt;img src="t_as_lm_files/figure-html/contrast_plt-1.png" style="display: block; margin: auto;" /&gt;

--
A One Sample T-Test.

---

# Dummy Codding for Dummy Models

1. The Categorical as Continuous

2. Assumptions of the Categorical

3. Interpretation of Categorical Results

4. .red[Variations on a Theme]

---

# The One-Sample T-Test

- We take some data

- We estimate it's mean and SE

- The "Test" and T come in in assessing if it's different from zero
     - We'll be talking about paradigms of inference later

--

- And.... isn't this just an intercept only model?

`$$\Large y_i = \beta_0 + \epsilon_i$$`
`$$\epsilon_i \sim \mathcal{N}(0, \sigma)$$`

---

# Consider Climate-Change Driven Range Shifts

- Is the distribution of range-shifts 0?

&lt;img src="t_as_lm_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;

.small[Chen, I-C., J. K. Hill, R. Ohlemüller, D. B. Roy, and C,. D. Thomas. 2011. Science 333:1024-1026.]

---

# Testing a Mean with an Intercept Only Model


```r
shift_mod &lt;- lm(elevationalRangeShift ~ 1, data = shift)
```

Coefficient
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39.32903 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.507258 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# What if we are looking at Change Between Pairs

- Classically, we have the **Paired T-Test**

- We look at differences between pairs
     - Could be One Individual over time
     - Could be two plots next to each other
     - Deliciously simple
     
- This is just an intercept only model where the Difference is our response variable

`$$\Large (y1 - y2)_i = \beta_0 + \epsilon_i$$`

---
# Does bird immunococompetence decrease after a testosterone implant?
.center[
![](images/09/blackbird.jpg)
]



---
# Differences in Antibody Performance
&lt;img src="t_as_lm_files/figure-html/blackbird_plot-1.png" style="display: block; margin: auto;" /&gt;

---
# Again, Intercept Only Model


LM Coefficients versus T-Test
&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std.error &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.538462 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.336215 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;






---
# Excess Baggage

- In this framework, you have to do ALL assumption tests

--

- BUT, t-tests have THE SAME ASSUMPTIONS

--

- BECASUE THEY ARE JUST LINEAR MODELS RE-ARRANGED

--

- AND, you gain flexibility in execution

--

- AND, you don't have to remember an arcane taxonomy of tests

--

`$$\large Y = \beta X + \epsilon$$`

---
# Remember - Even Under These Scenarios, Care for Your Golem
.center[
![:scale 50%](images/09/golem.png)

Even with the simplest data, you can still burn down Prague!]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="my_macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
